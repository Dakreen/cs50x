{% extends "layout.html" %}

{% block title %}
    Portfolio
{% endblock %}

{% block main %}
<div class="container mt-4">
  <h1 class="mb-4">Portfolio Overview</h1>
  <div class="row mb-4 text-center">
    <div class="col-md-3 col-sm-6 mb-3">
      <div class="card shadow-sm">
        <div class="card-body">
          <h6 class="text-muted mb-1">Username</h6>
          <h5 class="fw-bold">{{name}}</h5>
        </div>
      </div>
    </div>
    <div class="col-md-3 col-sm-6 mb-3">
      <div class="card shadow-sm">
        <div class="card-body">
          <h6 class="text-muted mb-1">Available Cash</h6>
          <h5 class="text-success fw-bold">{{cash}}</h5>
        </div>
      </div>
    </div>
    <div class="col-md-3 col-sm-6 mb-3">
      <div class="card shadow-sm">
        <div class="card-body">
          <h6 class="text-muted mb-1">Portfolio Value</h6>
          <h5 class="text-primary fw-bold">{{sum_value}}</h5>
        </div>
      </div>
    </div>
    <div class="col-md-3 col-sm-6 mb-3">
      <div class="card shadow-sm">
        <div class="card-body">
          <h6 class="text-muted mb-1">Total Balance</h6>
          <h5 class="fw-bold text-dark">{{balance}}</h5>
        </div>
      </div>
    </div>
  </div>
  <div class="table-responsive">
    <table class="table table-striped table-hover align-middle shadow-sm">
      <thead class="table-light">
        <tr>
          <th>Symbol</th>
          <th>Company Name</th>
          <th class="text-center">Shares</th>
          <th class="text-center">Current Price</th>
          <th class="text-center">Total Value</th>
          <th class="text-center">Actions</th>
        </tr>
      </thead>
      <tbody>
        {% for key in value %}
          <tr>
            <td>{{key.symbol}}</td>
            <td>{{lookup(key.symbol).name}}</td>
            <td class="text-center">{{key.shares}}</td>
            <td class="text-center">{{usd(key.price)}}</td>
            <td class="text-center">{{usd(key.total)}}</td>
            <td class="text-center">
              <a href="/buy?symbol={{key.symbol}}" class="btn btn-sm btn-success">Buy</a>
              <a href="/sell?symbol={{key.symbol}}" class="btn btn-sm btn-danger">Sell</a>
            </td>
          </tr>
        {% endfor %}
      </tbody>
      <tfoot class="table-light">
        <tr>
          <td colspan="4" class="text-end fw-bold">Cash:</td>
          <td class="text-center text-success fw-bold">{{cash}}</td>
          <td></td>
        </tr>
        <tr>
          <td colspan="4" class="text-end fw-bold">Grand Total:</td>
          <td class="text-center text-primary fw-bold">{{balance}}</td>
          <td></td>
        </tr>
      </tfoot>
    </table>
  </div>
</div>
{% endblock %}
